
// Task settings
const P_Exp = 0.75;

const x_margin = 110; // extra pixels around bounding box
const y_margin = 40;
const img_size = [960, 540];
const IntLims = [-20, 20];
const GiveFeedback = true;
const Blocklen = 24;
const possibleresp = ['f', 'j'];

// Staircase settings:
const start_int = 10;
const start_int_train = 10;
const min_int = 0.5;
const max_int = 20;
const step_size = 1; // to be halved after 3 reversals

const ndemotrials = 12;

// Stimulus directories:
const ProbeDir = `probe_images`;
const StimDir = `sequence_images`;

var box_coords = [ // lookup table of bounding boxes for every scene/view
  {0: [317, 343, 320, 162],
  60: [317, 343, 306, 162],
  120: [317, 345, 313, 159],
  180: [323, 343, 313, 161],
  240: [326, 343, 308, 162],
  300: [317, 343, 320, 161]},
  {0: [292, 334, 344, 168],
  60: [292, 336, 344, 156],
  120: [327, 345, 320, 151],
  180: [317, 341, 348, 151],
  240: [312, 334, 348, 168],
  300: [319, 334, 323, 169]},
  {0: [313, 350, 316, 140],
  60: [313, 350, 316, 140],
  120: [313, 350, 316, 140],
  180: [313, 350, 316, 140],
  240: [313, 350, 316, 140],
  300: [313, 350, 316, 140]},
  {0: [328, 333, 287, 157],
  60: [328, 333, 287, 157],
  120: [328, 333, 287, 157],
  180: [328, 333, 287, 157],
  240: [328, 333, 287, 157],
  300: [328, 333, 287, 157]},
  {0: [346, 280, 226, 220],
  60: [346, 280, 226, 220],
  120: [346, 280, 226, 220],
  180: [346, 280, 226, 220],
  240: [346, 280, 226, 220],
  300: [346, 280, 226, 220]},
  {0: [347, 353, 289, 142],
  60: [347, 353, 289, 142],
  120: [347, 353, 289, 142],
  180: [347, 353, 289, 142],
  240: [347, 353, 289, 142],
  300: [347, 353, 289, 142]},
  {0: [358, 350, 265, 149],
  60: [358, 350, 265, 149],
  120: [358, 350, 265, 149],
  180: [358, 350, 265, 149],
  240: [358, 350, 265, 149],
  300: [358, 350, 265, 149]},
  {0: [314, 338, 330, 162],
  60: [306, 339, 324, 163],
  120: [301, 341, 334, 161],
  180: [307, 339, 336, 161],
  240: [302, 338, 320, 162],
  300: [305, 338, 329, 162]},
  {0: [374, 330, 181, 175],
  60: [374, 330, 181, 175],
  120: [374, 330, 181, 175],
  180: [374, 330, 181, 175],
  240: [374, 330, 181, 175],
  300: [374, 330, 181, 175]},
  {0: [320, 350, 309, 142],
  60: [320, 350, 309, 142],
  120: [320, 350, 309, 142],
  180: [320, 350, 309, 142],
  240: [320, 350, 309, 142],
  300: [320, 350, 309, 142]},
  {0: [322, 353, 299, 137],
  60: [322, 353, 299, 137],
  120: [322, 353, 299, 137],
  180: [322, 353, 299, 137],
  240: [322, 353, 299, 137],
  300: [322, 353, 299, 137]},
  {0: [320, 352, 308, 140],
  60: [320, 352, 308, 140],
  120: [320, 352, 308, 140],
  180: [320, 352, 308, 140],
  240: [320, 352, 308, 140],
  300: [320, 352, 308, 140]},
  {0: [363, 323, 266, 175],
  60: [363, 323, 266, 175],
  120: [363, 323, 266, 175],
  180: [363, 323, 266, 175],
  240: [363, 323, 266, 175],
  300: [363, 323, 266, 175]},
  {0: [360, 336, 272, 160],
  60: [360, 336, 272, 160],
  120: [360, 336, 272, 160],
  180: [360, 336, 272, 160],
  240: [360, 336, 272, 160],
  300: [360, 336, 272, 160]},
  {0: [321, 349, 310, 154],
  60: [321, 349, 300, 154],
  120: [321, 352, 304, 149],
  180: [328, 350, 304, 151],
  240: [329, 349, 305, 154],
  300: [321, 349, 310, 154]},
  {0: [327, 349, 298, 145],
  60: [327, 349, 298, 145],
  120: [327, 349, 298, 145],
  180: [327, 349, 298, 145],
  240: [327, 349, 298, 145],
  300: [327, 349, 298, 145]},
  {0: [353, 362, 273, 138],
  60: [353, 362, 273, 138],
  120: [353, 362, 273, 138],
  180: [353, 362, 273, 138],
  240: [353, 362, 273, 138],
  300: [353, 362, 273, 138]},
  {0: [354, 349, 272, 154],
  60: [354, 349, 272, 154],
  120: [354, 349, 272, 154],
  180: [354, 349, 272, 154],
  240: [354, 349, 272, 154],
  300: [354, 349, 272, 154]},
  {0: [324, 350, 303, 147],
  60: [324, 350, 303, 147],
  120: [324, 350, 303, 147],
  180: [324, 350, 303, 147],
  240: [324, 350, 303, 147],
  300: [324, 350, 303, 147]},
  {0: [309, 307, 326, 196],
  60: [309, 308, 326, 185],
  120: [326, 314, 319, 183],
  180: [319, 311, 330, 183],
  240: [314, 308, 330, 196],
  300: [321, 307, 323, 197]}
];

// Trials for the main experiment:
var AllTrials = Create_AllTrials.run({'P_Exp': P_Exp, 'Demo': false,
                                      'StimDir': StimDir});
console.log(AllTrials);

const NBlocks = AllTrials.length/Blocklen;
console.log(NBlocks);

// Trials for the practice run:
var DemoTrials = Create_AllTrials.run({'P_Exp': P_Exp, 'Demo': true,
                                       'NDemoTrials': ndemotrials,
                                       'StimDir': StimDir});
// 1 = same, 0 = different:
var DemoSameDiff = GA_utils.shuffle(GA_utils.reparray([0, 1], ndemotrials/2));

const stair_params = {
   ndown: 2,
   startingInt_train: start_int_train,
   startingInt_main: start_int,
   minInt: min_int,
   maxInt: max_int,
   stepSize: step_size
};
